/*! jQueryUI Form Dialog
 * Create preconfigured jQueryUI dialog forms.
 * 
 * Version: 0.7.0
 * Home: https://github.com/Dormilich/jqueryui-form-dialog
 * Copyright (c) 2015 Bertold von Dormilich
 * 
 * Licensed under the MIT license.
 */
!function(a){function b(b,c){a("<pre/>").text(c).dialog({title:b,close:function(){a(this).dialog("destroy").remove()}})}function c(b){try{var c=b.responseJSON;c.form&&a.each(c.form,function(a,b){this.find('*[name="'+a+'"]:first').before(d(b))}.bind(this)),c.error&&this.find("form").addBack("form").prepend(d([c.error]))}catch(e){window.console.log(e.message)}}function d(b){var c=a('<ul class="error"/>'),d=a("<li/>");return a.each(b,function(a,b){d.clone().text(b).appendTo(c)}),c}a.fn.formDialog=function(c,d){var e,f,g;return a.isFunction(c)&&(d=c),"object"!=typeof c&&(c={}),e=a.fn.formDialog,f=a.extend({},e.defaults),a.each(c,function(a,b){a in f&&(f[a]=b)}),"buttons"in c||(c.buttons=[]),a.isFunction(f.formData)||(f.formData=e.formalise),"close"in c||!c.remove||(c.close=function(){a(this).dialog("destroy").remove()}),g=[{text:e.translate(f.language,f.actionLabel),click:function(c){var g,h=c.target,i=a(this),j=e.getForm(i);return j.find(":invalid").length>0?!1:(h.disabled=!0,i.find("ul.error").remove(),g=a.ajax(j.prop("action"),{type:j.prop("method"),data:f.formData.call(j[0],j),context:i,statusCode:f.http}).always(function(){h.disabled=!1}).fail(function(a){a.status in f.http||(this.dialog("close"),a.responseText&&b(e.translate(f.language,"Error"),a.responseText))}),f.autoClose&&g.done(function(){this.dialog("close")}),f.formReset&&g.done(function(){j[0].reset()}),a.isFunction(f.success)&&g.done(f.success),void(a.isFunction(d)&&g.done(d)))}},{text:e.translate(f.language,"Cancel"),click:function(){a(this).dialog("close")}}],this.each(function(){var b=a.extend({},f),d=a(this);a.each(this.dataset,function(a){b[a]=d.data(a)}),a.extend(b,c),e.getForm(d).length>0&&(b.buttons=a.merge(e.buttonise(c.buttons),g)),d.dialog(b)})},a.fn.formDialog.formalise=function(a){return a.serialize()},a.fn.formDialog.buttonise=function(b){return a.map(b,function(b,c){return a.isFunction(b)?{click:b,text:c}:b})},a.fn.formDialog.getForm=function(a){return a.find("form").addBack("form").eq(0)},a.fn.formDialog.translate=function(b,c){var d=a.fn.formDialog.dictionary;return b in d&&c in d[b]?d[b][c]:c},a.fn.formDialog.dictionary={de:{Cancel:"Abbrechen",Delete:"LÃ¶schen",Edit:"Bearbeiten",Error:"Fehler",Save:"Speichern"}},a.fn.formDialog.defaults={autoOpen:!1,width:500,language:"en",actionLabel:"Save",autoClose:!0,formData:a.fn.formDialog.formalise,formReset:!0,success:null,remove:!1,http:{400:c}}}(jQuery);