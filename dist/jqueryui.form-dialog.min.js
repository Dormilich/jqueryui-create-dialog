/*! jQueryUI Form Dialog
 * Create preconfigured jQueryUI dialog forms.
 * 
 * Version: 0.5.0
 * Home: https://github.com/Dormilich/jqueryui-form-dialog
 * Copyright (c) 2015 Bertold von Dormilich
 * 
 * Licensed under the MIT license.
 */
!function(a){function b(b,c){a("<pre/>").text(c).dialog({title:b,close:function(){a(this).dialog("destroy").remove()}})}function c(b){try{var c=b.responseJSON;c.form&&a.each(c.form,function(a,b){this.find('*[name="'+a+'"]:first').before(d(b))}.bind(this)),c.error&&this.find("form").addBack("form").prepend(d([c.error]))}catch(e){window.console.log(e.message)}}function d(b){var c=a('<ul class="error"/>'),d=a("<li/>");return a.each(b,function(a,b){d.clone().text(b).appendTo(c)}),c}a.fn.formDialog=function(d,e){var f,g,h;return a.isFunction(d)&&(e=d),"object"!=typeof d&&(d={}),f=a.fn.formDialog,g=a.extend({},f.defaults),a.each(d,function(a,b){a in g&&(g[a]=b)}),"buttons"in d||(d.buttons=[]),a.isFunction(g.formData)||(g.formData=f.formalise),"close"in d||!d.remove||(d.close=function(){a(this).dialog("destroy").remove()}),h=[{text:f.translate(g.language,g.actionLabel),click:function(d){var h,i=d.target,j=a(this),k=f.getForm(j);return k.find(":invalid").length>0?!1:(i.disabled=!0,j.find("ul.error").remove(),h=a.ajax(k.prop("action"),{type:k.prop("method"),data:g.formData.call(k[0],k),context:j,statusCode:{400:c,500:function(a,c,d){this.dialog("close"),b(f.translate(g.language,"Error"),a.responseText||d)}}}).always(function(){i.disabled=!1}),g.autoClose&&h.done(function(){this.dialog("close")}),a.isFunction(g.success)&&h.done(g.success),void(a.isFunction(e)&&h.done(e)))}},{text:f.translate(g.language,"Cancel"),click:function(){a(this).dialog("close")}}],this.each(function(){var b=a.extend({},g),c=a(this);a.each(this.dataset,function(a){b[a]=c.data(a)}),a.extend(b,d),f.getForm(c).length>0&&(b.buttons=a.merge(f.buttonise(d.buttons),h)),c.dialog(b)})},a.fn.formDialog.formalise=function(a){return a.serialize()},a.fn.formDialog.buttonise=function(b){return a.map(b,function(b,c){return a.isFunction(b)?{click:b,text:c}:b})},a.fn.formDialog.getForm=function(a){return a.find("form").addBack("form").eq(0)},a.fn.formDialog.translate=function(b,c){var d=a.fn.formDialog.dictionary;return b in d&&c in d[b]?d[b][c]:c},a.fn.formDialog.dictionary={de:{Cancel:"Abbrechen",Delete:"LÃ¶schen",Edit:"Bearbeiten",Error:"Fehler",Save:"Speichern"}},a.fn.formDialog.defaults={autoOpen:!1,width:500,language:"en",actionLabel:"Save",autoClose:!0,formData:a.fn.formDialog.formalise,success:null,remove:!1}}(jQuery);